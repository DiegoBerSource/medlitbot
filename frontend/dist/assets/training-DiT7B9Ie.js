import{O as p,r as c,e as v}from"./vendor-CqXe5Vco.js";import{m as u}from"./index-D07s5EKd.js";const A=p("training",()=>{const n=c([]),s=c([]),i=c(null),o=c(!1),r=c(null),d=v(()=>({active:n.value.filter(e=>e.status==="running"),completed:n.value.filter(e=>e.status==="completed"),failed:n.value.filter(e=>e.status==="failed"),pending:n.value.filter(e=>e.status==="pending")})),g=v(()=>n.value.length),b=v(()=>d.value.active.length),m=v(()=>n.value.slice().sort((e,t)=>{const a=e.started_at?new Date(e.started_at).getTime():0;return(t.started_at?new Date(t.started_at).getTime():0)-a}).slice(0,10));return{jobs:n,activeJobs:s,currentJob:i,loading:o,error:r,jobsByStatus:d,totalJobs:g,activeJobCount:b,recentJobs:m,fetchJobs:async()=>{o.value=!0,r.value=null;try{const e=await u.getModels(),t=[];for(const a of e.items||[])try{const l=await u.getTrainingJob(a.id);t.push(l)}catch{}n.value=t,s.value=n.value.filter(a=>a.status==="running")}catch(e){r.value=e instanceof Error?e.message:"Failed to fetch training jobs",console.error("Failed to fetch training jobs:",e)}finally{o.value=!1}},fetchActiveJobs:async()=>{o.value=!0,r.value=null;try{const e=await u.getModels(),t=[];for(const a of e.items||[])if(a.status==="training")try{const l=await u.getTrainingJob(a.id);t.push(l)}catch{}s.value=t}catch(e){r.value=e instanceof Error?e.message:"Failed to fetch active jobs",console.error("Failed to fetch active jobs:",e)}finally{o.value=!1}},fetchJob:async e=>{o.value=!0,r.value=null;try{return i.value=await u.getTrainingJob(e),i.value}catch(t){throw r.value=t instanceof Error?t.message:"Failed to fetch training job",console.error("Failed to fetch training job:",t),t}finally{o.value=!1}},startTraining:async(e,t)=>{o.value=!0,r.value=null;try{const a=await u.startTraining(e,t);return n.value.unshift(a),s.value.unshift(a),i.value=a,a}catch(a){throw r.value=a instanceof Error?a.message:"Failed to start training",console.error("Failed to start training:",a),a}finally{o.value=!1}},startHyperparameterOptimization:async(e,t)=>{o.value=!0,r.value=null;try{const a=await u.optimizeHyperparameters(e,t),l={id:a.optimization_id||0,model:e,status:"running",progress_percentage:0,current_epoch:0,total_epochs:t.n_trials||10,current_loss:null,current_accuracy:null,started_at:new Date().toISOString(),completed_at:null,error_message:null,celery_task_id:a.task_id||"",model_id:e,updated_at:new Date().toISOString()};return n.value.unshift(l),s.value.unshift(l),i.value=l,a}catch(a){throw r.value=a instanceof Error?a.message:"Failed to start hyperparameter optimization",console.error("Failed to start hyperparameter optimization:",a),a}finally{o.value=!1}},stopJob:async e=>{o.value=!0,r.value=null;try{await u.stopTraining(e);const t=n.value.findIndex(l=>l.model_id===e);t!==-1&&(n.value[t]={...n.value[t],status:"cancelled"});const a=s.value.findIndex(l=>l.model_id===e);a!==-1&&s.value.splice(a,1),i.value?.model_id===e&&(i.value={...i.value,status:"cancelled"})}catch(t){throw r.value=t instanceof Error?t.message:"Failed to stop training job",console.error("Failed to stop training job:",t),t}finally{o.value=!1}},deleteJob:async e=>{o.value=!0,r.value=null;try{await u.deleteModel(e),n.value=n.value.filter(t=>t.model_id!==e),s.value=s.value.filter(t=>t.model_id!==e),i.value?.model_id===e&&(i.value=null)}catch(t){throw r.value=t instanceof Error?t.message:"Failed to delete training job",console.error("Failed to delete training job:",t),t}finally{o.value=!1}},updateJobProgress:(e,t)=>{const a=n.value.findIndex(f=>f.id===e);a!==-1&&(n.value[a]={...n.value[a],...t});const l=s.value.findIndex(f=>f.id===e);l!==-1&&(s.value[l]={...s.value[l],...t}),i.value?.id===e&&(i.value={...i.value,...t})},clearError:()=>{r.value=null},clearCurrentJob:()=>{i.value=null},clearJobs:()=>{n.value=[],s.value=[]}}});export{A as u};
//# sourceMappingURL=training-DiT7B9Ie.js.map
